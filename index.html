<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Guide: Pano_ID Integration for Tonton & REVID</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- New design and color palette inspired by the provided Tonton logo image -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* Very dark background for a slick, modern feel */
            color: #e2e8f0; /* Light gray for main text on dark background */
        }
        .step-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(255, 255, 255, 0.1), 0 2px 4px -1px rgba(255, 255, 255, 0.06);
        }
        .step-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 25px -5px rgba(255, 255, 255, 0.1), 0 10px 10px -5px rgba(255, 255, 255, 0.04);
        }
        .code-block {
            background-color: #1a202c; /* Slightly darker than cards for contrast */
            color: #f9fafb;
            border-radius: 0.75rem;
            padding: 1.5rem;
            position: relative;
        }
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: #2d3748;
            color: #f9fafb;
            border: none;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background-color 0.2s, transform 0.2s;
        }
        .copy-btn:hover {
            background-color: #4a5568;
            transform: scale(1.05);
        }
        .flow-arrow {
            color: #4a5568; /* Subtle gray for arrows */
        }
        .api-tab {
            transition: all 0.2s ease-in-out;
        }
        .active-tab {
            background-color: #00aaff; /* A vibrant blue to match the logo */
            color: #111827;
            border-radius: 0.5rem 0.5rem 0 0;
            font-weight: 600;
        }
        .api-tab:not(.active-tab) {
            background-color: #2d3748;
            color: #e2e8f0;
        }
        .process-list li {
            position: relative;
            padding-left: 2.5rem;
            margin-bottom: 1.5rem;
        }
        .process-list li::before {
            content: attr(data-step);
            position: absolute;
            left: 0;
            top: 0;
            width: 2rem;
            height: 2rem;
            background-color: #00aaff;
            color: #111827;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 700;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto p-4 sm:p-6 lg:p-8 max-w-6xl">

        <header class="text-center mb-12 py-12 bg-gradient-to-r from-yellow-400 via-sky-400 to-rose-500 text-white rounded-xl shadow-lg">
            <!-- Updated H1: Removed the SVG icon and set all text to white -->
            <h1 class="text-4xl md:text-5xl font-bold flex items-center justify-center">
                <span class="text-white">Tonton</span>
                <span class="text-white">&nbsp;& REVID Integration</span>
            </h1>
            <p class="mt-2 text-lg text-white">An Interactive Guide to Using Lotame's Panorama ID™</p>
        </header>

        <main>
            <section id="overview" class="mb-16 bg-gray-800 p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-gray-100 mb-4">What is a Panorama ID?</h2>
                <p class="text-gray-300 leading-relaxed">
                    The Panorama ID (`pano_id`) is a unique, privacy-first identifier from Lotame that helps connect a user's activity across different devices like mobile phones, tablets, and smart TVs. Unlike cookies, it's designed for the modern digital world, allowing for a unified view of a user without relying on third-party tracking. For the Tonton app, it provides a stable and reliable way to identify users for the REVID system.
                </p>
            </section>

            <section id="integration-flow" class="mb-16">
                <h2 class="text-3xl font-bold text-center text-gray-100 mb-10">The Server-Side Integration Flow</h2>
                
                <div class="grid grid-cols-1 gap-8 items-start">
                    
                    <div class="step-card bg-gray-800 p-6 rounded-xl shadow-lg col-span-1">
                        <div class="flex items-center mb-4">
                            <div class="bg-blue-400 text-gray-900 rounded-full h-12 w-12 flex items-center justify-center text-xl font-bold">1</div>
                            <h3 class="ml-4 text-xl font-semibold text-gray-100">Tonton App Collects MAID</h3>
                        </div>
                        <p class="text-gray-300">The process begins on the user's device. The Tonton mobile app obtains the Mobile Advertiser ID (MAID), which is the standard identifier for advertising purposes on iOS and Android.</p>
                        <div class="mt-4 space-y-2">
                            <div class="bg-gray-700 p-2 rounded-md font-mono text-sm text-gray-300"><strong>iOS:</strong> IDFA</div>
                            <div class="bg-gray-700 p-2 rounded-md font-mono text-sm text-gray-300"><strong>Android:</strong> GAID</div>
                        </div>
                    </div>

                    <div class="flex justify-center items-center">
                        <div class="text-4xl flow-arrow">&darr;</div>
                    </div>

                    <div class="step-card bg-gray-800 p-6 rounded-xl shadow-lg col-span-1">
                        <div class="flex items-center mb-4">
                            <div class="bg-blue-400 text-gray-900 rounded-full h-12 w-12 flex items-center justify-center text-xl font-bold">2</div>
                            <h3 class="ml-4 text-xl font-semibold text-gray-100">Tonton Backend Calls Lotame API</h3>
                        </div>
                        <p class="text-gray-300 mb-4">Tonton's backend server makes a secure <code class="bg-gray-700 text-sm p-1 rounded">POST</code> request to the Lotame Panorama ID API, sending the user's MAID. This is the core step to translate a device ID into a persistent `pano_id`. Click below to see the request structure and the expected successful response.</p>
                        
                        <div class="mb-4">
                            <div class="flex border-b border-gray-700">
                                <button id="req-btn" class="api-tab py-2 px-4 font-medium text-sm focus:outline-none active-tab rounded-tl-xl">Request</button>
                                <button id="res-btn" class="api-tab py-2 px-4 font-medium text-sm focus:outline-none rounded-tr-xl">Response</button>
                            </div>
                        </div>

                        <div id="request-content">
                            <p class="text-sm text-gray-400 mb-2"><strong>Endpoint:</strong> <code class="bg-gray-700 text-xs p-1 rounded">/server-side-panorama-id-api-for-mobile-app-maids</code></p>
                            <div class="code-block">
                                <button class="copy-btn" onclick="copyToClipboard('requestCode')">Copy</button>
                                <pre id="requestCode"><code class="language-json">{
  "id": "a1b2c3d4-e5f6-7890-1234-567890abcdef",
  "id_type": "gaid",
  "client_id": 12345,
  "consent": {
    "consent_data": "xxxxxxxxxx",
    "consent_type": "TCF_V2"
  }
}</code></pre>
                            </div>
                        </div>

                        <div id="response-content" class="hidden">
                             <p class="text-sm text-gray-400 mb-2">A successful response contains the `pano_id`.</p>
                             <div class="code-block">
                                <button class="copy-btn" onclick="copyToClipboard('responseCode')">Copy</button>
                                <pre id="responseCode"><code class="language-json">{
  "pano_id": "e480a48a23eb6b8c882401640c3456945a7020ad0470402219bcec77d43b406e",
  "expires": 604800
}</code></pre>
                            </div>
                        </div>
                    </div>

                    <div class="flex justify-center items-center">
                        <div class="text-4xl flow-arrow">&darr;</div>
                    </div>

                     <div class="step-card bg-gray-800 p-6 rounded-xl shadow-lg col-span-1">
                        <div class="flex items-center mb-4">
                            <div class="bg-blue-400 text-gray-900 rounded-full h-12 w-12 flex items-center justify-center text-xl font-bold">3</div>
                            <h3 class="ml-4 text-xl font-semibold text-gray-100">Forward `pano_id` to REVID System</h3>
                        </div>
                        <p class="text-gray-300">Once the `pano_id` is received from Lotame, Tonton's backend system forwards this ID to the REVID system. The `pano_id` now acts as the primary, unified identifier for this user within the REVID ecosystem.</p>
                        <div class="mt-4 bg-green-900 border border-green-700 p-4 rounded-lg flex items-center">
                            <span class="text-2xl mr-3">✅</span>
                            <div>
                                <p class="font-semibold text-green-300">Integration Complete</p>
                                <p class="text-green-400 text-sm">REVID can now use the stable `pano_id` for user recognition.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <section id="audience-extraction-flow" class="mb-16 bg-gray-800 p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-gray-100 mb-4">Audience Extraction API In-App Environment</h2>
                <p class="text-gray-300 leading-relaxed mb-4">
                    It is possible to use the Audience Extraction API within a mobile application environment. Use the Audience Extraction API in-app to return audience IDs for use within an ad server or to serve custom/personal content.
                </p>
                <h3 class="text-2xl font-bold text-gray-100 mb-4">Sample of Extraction API In-App</h3>
                <div class="code-block mb-4">
                    <button class="copy-btn" onclick="copyToClipboard('audienceUrl')">Copy</button>
                    <pre id="audienceUrl"><code class="language-text">https://ad.crwdcntrl.net/5/c=&lt;your client id&gt;/e=app/mid=&lt;mobile device id&gt;/dt=&lt;idfa/gaid&gt;/pe=y</code></pre>
                </div>
                <p class="text-gray-300 leading-relaxed mb-4">
                    The main difference between the HTML and app environment is the need to append the mobile device ID (MID) into the call. This is due to in-app security which limits what third-party code can pick up.
                </p>
                <h3 class="text-2xl font-bold text-gray-100 mb-4">Process</h3>
                <ol class="process-list text-gray-300 mb-6">
                    <li data-step="1">App developer injects mobile device ID into the extraction API (see above)</li>
                    <li data-step="2">Extraction API is fired returning the audience ids</li>
                    <li data-step="3">App developer injects audience ids into the ad tag (Contact your ad server support team for confirmation where the tags should be injected)</li>
                </ol>
                <p class="text-gray-300 leading-relaxed italic text-sm mb-4">
                    Note the audience ids are returned as a JSON object
                </p>
                <h3 class="text-2xl font-bold text-gray-100 mb-4">How It Works</h3>
                <ol class="process-list text-gray-300">
                    <li data-step="1">App loads</li>
                    <li data-step="2">Client triggers with the MID being passed into the call</li>
                    <li data-step="3">Audience IDs returned and passed into ad server / app CMS</li>
                    <li data-step="4">Campaigns within the ad server deliver when a relevant audience IDs is seen in the ad call</li>
                </ol>
            </section>

            <section id="in-app-flow" class="mb-16 bg-gray-800 p-8 rounded-xl shadow-lg">
                <h2 class="text-3xl font-bold text-gray-100 mb-4">Returning Panorama ID™ In-App</h2>
                <p class="text-gray-300 leading-relaxed mb-4">
                    If you have a use-case to return the Panorama ID™ in your In-App environment, then that can be accommodated by passing the extra <code class="bg-gray-700 text-xs p-1 rounded">rid=y</code> parameter on your URL. For example:
                </p>
                <div class="code-block mb-4">
                    <button class="copy-btn" onclick="copyToClipboard('inAppUrl')">Copy</button>
                    <pre id="inAppUrl"><code class="language-text">https://ad.crwdcntrl.net/5/c=&lt;your client id&gt;/e=app/mid=&lt;mobile device id&gt;/dt=&lt;idfa/gaid&gt;/pe=y/rid=y</code></pre>
                </div>
                <p class="text-gray-300 leading-relaxed mb-4">
                    Doing so will add the <code class="bg-gray-700 text-xs p-1 rounded">panoramaId</code> to the response. For example:
                </p>
                <div class="code-block">
                    <button class="copy-btn" onclick="copyToClipboard('inAppResponse')">Copy</button>
                    <pre id="inAppResponse"><code class="language-json">
ccaads":{
  "Profile": {
    "tpid": "c8ef27a0d4ba771a81159f0d2e792db4",
    "pid": "d99c5ba37b680159749c82487927336b",
    "panoramaId": "e480a48a23eb6b8c882401640c3456945a7020ad0470402219bcec77d43b406e",
    "Audiences": {
      ...
    }
  }
}
                    </code></pre>
                </div>
            </section>

            <section id="takeaways" class="mb-16">
                <h2 class="text-3xl font-bold text-center text-gray-100 mb-10">Key Takeaways</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <h3 class="font-semibold text-lg text-gray-100 mb-2">Server-Side is Key</h3>
                        <p class="text-gray-300 text-sm">The entire process of retrieving the `pano_id` is handled securely between servers, not on the user's device.</p>
                    </div>
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <h3 class="font-semibold text-lg text-gray-100 mb-2">MAID is the Input</h3>
                        <p class="text-gray-300 text-sm">The Lotame API requires the user's Mobile Advertiser ID (GAID or IDFA) to generate the `pano_id`.</p>
                    </div>
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg">
                        <h3 class="font-semibold text-lg text-gray-100 mb-2">`pano_id` is the Output</h3>
                        <p class="text-gray-300 text-sm">The `pano_id` from the API response is the definitive, persistent identifier to send to the REVID system.</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-12 pt-8 border-t border-gray-700">
            <p class="text-sm text-gray-400">&copy; 2025 Tonton Switch Team. This guide is for internal use.</p>
        </footer>

    </div>

    <script>
        const reqBtn = document.getElementById('req-btn');
        const resBtn = document.getElementById('res-btn');
        const reqContent = document.getElementById('request-content');
        const resContent = document.getElementById('response-content');
        const tabs = [reqBtn, resBtn];
        const contents = [reqContent, resContent];

        function switchTab(activeIndex) {
            tabs.forEach((tab, index) => {
                if (index === activeIndex) {
                    tab.classList.add('active-tab');
                    contents[index].classList.remove('hidden');
                } else {
                    tab.classList.remove('active-tab');
                    contents[index].classList.add('hidden');
                }
            });
        }

        reqBtn.addEventListener('click', () => switchTab(0));
        resBtn.addEventListener('click', () => switchTab(1));

        function copyToClipboard(elementId) {
            const textToCopy = document.getElementById(elementId).innerText;
            
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = textToCopy;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            
            try {
                document.execCommand('copy');
                alert('Copied to clipboard!');
            } catch (err) {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard.');
            } finally {
                document.body.removeChild(tempTextArea);
            }
        }
    </script>
</body>
</html>
